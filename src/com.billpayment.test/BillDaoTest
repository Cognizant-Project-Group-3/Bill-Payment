package com.billpayment.test;

import java.sql.SQLException;

import junit.framework.Assert;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;

import com.billpayment.dao.BillDAO;

public class BillDaoTest {
	BillDAO billDao;

	@Before
	public void setUp() throws Exception {
		billDao=new BillDAO();
	}

	@After
	public void tearDown() throws Exception {
		billDao=null;
	}

	@Test
	public void testGetVendorId() {
		try{
			int vId = billDao.getVendorId("Airtel", "Telephone");
			Assert.assertEquals(1001, vId);
		}catch(ClassNotFoundException cnfe){
			cnfe.printStackTrace();
		}catch(SQLException se){
			se.printStackTrace();
		}
	}

	@Test
	public void testGetCustomerIdPositive() throws ClassNotFoundException, SQLException {
		int cId = billDao.getCustomerId(100);
		Assert.assertEquals(100, cId);
	}
	
	@Test
	public void testGetCustomerIdNegative() {
		try{
		int cId = billDao.getCustomerId(1234);
		Assert.assertEquals(0, cId);
		}catch(ClassNotFoundException cnfe){
			cnfe.printStackTrace();
		}catch(SQLException se){
			se.printStackTrace();
		}
	}

	@Test
	public void testPendingAmount() {
		try{
		float pendingAmt=billDao.pendingAmount(100, 1001);
		Assert.assertEquals(1400f, pendingAmt);
		}catch(ClassNotFoundException cnfe){
			cnfe.printStackTrace();
		}catch(SQLException se){
			se.printStackTrace();
		}
		
	}

	@Test
	public void testUpdatePendingAmountDao() {
		int status=0;
		try
		{
			status=billDao.updatePendingAmountDao(101, 1003, 4000);
			Assert.assertEquals(1, status);
		}catch(ClassNotFoundException cnfe){
			cnfe.printStackTrace();
		}catch(SQLException se){
			se.printStackTrace();
		}
	}

}
